<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Roleta com Dono</title>
<style>
body { background:#111; color:#eee; font-family:Arial; text-align:center }
.box { background:#1e1e1e; padding:20px; margin:20px auto; width:300px; border-radius:10px }
input, select, button { width:90%; padding:10px; margin:5px }
button { cursor:pointer }
</style>
</head>
<body>

<div class="box" id="login">
  <h2>Login</h2>
  <input id="nome" placeholder="Nome">
  <input id="senha" type="password" placeholder="Senha">
  <select id="tipo">
    <option value="user">UsuÃ¡rio</option>
    <option value="admin">Dono</option>
  </select>
  <button onclick="entrar()">Entrar</button>
</div>

<div class="box" id="usuario" style="display:none">
  <h2>UsuÃ¡rio</h2>
  <button onclick="pedir()">Pedir acesso</button>
  <button onclick="rolar()" id="btnRolar" disabled>ðŸŽ² Rolar</button>
  <p id="res"></p>
</div>

<div class="box" id="dono" style="display:none">
  <h2>Dono</h2>
  <h3>Pedidos</h3>
  <div id="pedidos"></div>
  <h3>Resultados</h3>
  <div id="historico"></div>
</div>

<script>
let usuarioAtual = "";

function entrar(){
  const nome = document.getElementById("nome").value;
  const senha = document.getElementById("senha").value;
  const tipo = document.getElementById("tipo").value;

  if(!nome || !senha) return alert("Preencha tudo");
  if(senha !== "RC1") return alert("Senha errada");

  usuarioAtual = nome;
  login.style.display = "none";

  if(tipo === "admin"){
    dono.style.display = "block";
    carregarPedidos();
    carregarResultados();
  } else {
    usuario.style.display = "block";
    verificarAprovacao();
  }
}

function pedir(){
  let pedidos = JSON.parse(localStorage.getItem("pedidos")) || {};
  pedidos[usuarioAtual] = false;
  localStorage.setItem("pedidos", JSON.stringify(pedidos));
  alert("Pedido enviado ao dono");
}

function carregarPedidos(){
  setInterval(() => {
    let pedidos = JSON.parse(localStorage.getItem("pedidos")) || {};
    pedidosDiv = "";
    for(let nome in pedidos){
      if(pedidos[nome] === false){
        pedidosDiv += `
          <p>${nome}
          <button onclick="aprovar('${nome}')">Aceitar</button>
          <button onclick="recusar('${nome}')">Recusar</button></p>
        `;
      }
    }
    pedidos.innerHTML = pedidosDiv;
  }, 1000);
}

function aprovar(nome){
  let pedidos = JSON.parse(localStorage.getItem("pedidos"));
  pedidos[nome] = true;
  localStorage.setItem("pedidos", JSON.stringify(pedidos));
}

function recusar(nome){
  let pedidos = JSON.parse(localStorage.getItem("pedidos"));
  delete pedidos[nome];
  localStorage.setItem("pedidos", JSON.stringify(pedidos));
}

function verificarAprovacao(){
  setInterval(() => {
    let pedidos = JSON.parse(localStorage.getItem("pedidos")) || {};
    if(pedidos[usuarioAtual] === true){
      btnRolar.disabled = false;
    }
  }, 1000);
}

function rolar(){
  const n = Math.floor(Math.random()*10)+1;
  res.innerText = "VocÃª tirou: " + n;

  let hist = JSON.parse(localStorage.getItem("resultados")) || [];
  hist.push({nome:usuarioAtual, numero:n});
  localStorage.setItem("resultados", JSON.stringify(hist));
}

function carregarResultados(){
  setInterval(() => {
    let hist = JSON.parse(localStorage.getItem("resultados")) || [];
    historico.innerHTML = hist.map(h=>`${h.nome} tirou ${h.numero}`).join("<br>");
  }, 1000);
}
</script>

</body>
</html>
