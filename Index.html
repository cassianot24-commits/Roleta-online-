<!DOCTYPE html><html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Roleta Online 1 a 10</title>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <style>
    body { font-family: Arial, sans-serif; background:#0f0f0f; color:#eee; text-align:center; }
    .box { background:#1e1e1e; padding:20px; margin:20px auto; width:320px; border-radius:10px; }
    input, button { padding:10px; margin:5px; width:90%; }
    button { cursor:pointer; }
    #adminPanel, #userPanel { display:none; }
    li { background:#2a2a2a; margin:5px; padding:8px; border-radius:5px; }
  </style>
</head>
<body><h1>ðŸŽ¯ Roleta Online</h1><div class="box" id="loginBox">
  <h2>Login</h2>
  <input id="name" placeholder="Nome" />
  <input id="role" placeholder="USUARIO ou DONO" />
  <input id="password" type="password" placeholder="Senha" />
  <button onclick="login()">Entrar</button>
</div><div class="box" id="userPanel">
  <h2>Painel do UsuÃ¡rio</h2>
  <p id="status">Sem permissÃ£o</p>
  <button onclick="requestRoll()">Pedir permissÃ£o</button>
  <button id="rollBtn" onclick="roll()" disabled>ðŸŽ² Girar Roleta</button>
  <p id="result"></p>
</div><div class="box" id="adminPanel">
  <h2>Painel do DONO</h2>
  <ul id="requests"></ul>
</div><script>
// ðŸ”¥ CONFIGURE SEU FIREBASE AQUI
const firebaseConfig = {
  apiKey: "SUA_API_KEY",
  authDomain: "SEU_PROJETO.firebaseapp.com",
  projectId: "SEU_PROJETO",
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

let currentUser = "";
let isAdmin = false;
let myRequestId = null;

function login(){
  const name = document.getElementById('name').value;
  const role = document.getElementById('role').value;
  const password = document.getElementById('password').value;

  if(role === 'DONO' && password === 'RC1'){
    isAdmin = true;
    currentUser = name;
    document.getElementById('loginBox').style.display='none';
    document.getElementById('adminPanel').style.display='block';
    listenRequests();
  } else if(role === 'USUARIO' && password === 'RC'){
    currentUser = name;
    document.getElementById('loginBox').style.display='none';
    document.getElementById('userPanel').style.display='block';
    listenMyRequest();
  } else {
    alert('Credenciais invÃ¡lidas');
  }
}

function requestRoll(){
  db.collection("requests").add({
    user: currentUser,
    status: "aguardando",
    created: Date.now()
  }).then(doc => {
    myRequestId = doc.id;
    document.getElementById('status').innerText = 'Aguardando aprovaÃ§Ã£o';
  });
}

function listenRequests(){
  db.collection("requests").onSnapshot(snapshot => {
    const ul = document.getElementById('requests');
    ul.innerHTML = '';
    snapshot.forEach(doc => {
      const data = doc.data();
      if(data.status === 'aguardando'){
        const li = document.createElement('li');
        li.innerHTML = `${data.user} 
          <button onclick="approve('${doc.id}')">Aceitar</button>
          <button onclick="deny('${doc.id}')">Recusar</button>`;
        ul.appendChild(li);
      }
    });
  });
}

function approve(id){
  db.collection("requests").doc(id).update({ status: 'aprovado' });
}

function deny(id){
  db.collection("requests").doc(id).update({ status: 'recusado' });
}

function listenMyRequest(){
  db.collection("requests").onSnapshot(snapshot => {
    snapshot.forEach(doc => {
      if(doc.id === myRequestId){
        const data = doc.data();
        if(data.status === 'aprovado'){
          document.getElementById('status').innerText = 'PermissÃ£o concedida';
          document.getElementById('rollBtn').disabled = false;
        }
        if(data.status === 'recusado'){
          document.getElementById('status').innerText = 'PermissÃ£o recusada';
        }
      }
    });
  });
}

function roll(){
  const value = Math.floor(Math.random()*10)+1;
  document.getElementById('result').innerText = 'ðŸŽ‰ VocÃª tirou: ' + value;
  db.collection("logs").add({ user: currentUser, result: value, time: Date.now() });
}
</script></body>
</html>
